<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"> 
    <title data-i18n="app_title">Flavor Wheel Note | é¢¨å‘³è¼ªç­†è¨˜</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
        // On page load or when changing themes, best to add inline in `head` to avoid FOUC
        // 1. æª¢æŸ¥ localStorage ä¸­æ˜¯å¦æœ‰ 'theme' è¨­ç½®
        // 2. å¦‚æœæ²’æœ‰ï¼Œå‰‡æª¢æŸ¥ç”¨æˆ¶ç³»çµ±çš„åå¥½ (prefers-color-scheme)
        // 3. æ ¹æ“šçµæœåœ¨ <html> å…ƒç´ ä¸Šæ·»åŠ æˆ–ç§»é™¤ 'dark' class
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
            localStorage.setItem('theme', 'dark'); // å¦‚æœæ˜¯æ ¹æ“šç³»çµ±åå¥½ï¼Œå‰‡æ˜ç¢ºè¨­å®š
        } else {
            document.documentElement.classList.remove('dark');
            localStorage.setItem('theme', 'light');
        }
    </script>
    <script>
        // è¼‰å…¥ Tailwind CDN ä¹‹å¾Œï¼Œå†è¨­å®šå…¶ config
        tailwind.config = {
            darkMode: 'class'
        }
    </script>
    <style> 
        /* D3.js å…ƒç´ çš„é€šç”¨æ¨£å¼ */
        .flavor-arc {
            stroke: #fff;
            stroke-width: 1px;
            cursor: pointer;
            transition: opacity 0.2s;
        }
        .flavor-arc:hover {
            opacity: 0.85;
        }
        /* é‡å° Layer 1 (å¤§é¡åˆ¥)ï¼Œæ”¹è®Šæ»‘é¼ æ¸¸æ¨™ï¼Œæš—ç¤ºå…¶ä¸å¯é»æ“Š */
        .flavor-arc.layer-1 {
            cursor: default;
        }
        .flavor-label {
            font-family: sans-serif;
            fill: #fff; /* æ”¹ç‚ºç™½è‰²æ–‡å­— */
            pointer-events: none; /* Don't block clicks on arcs */
            /* text-shadow: 0px 0px 5px rgba(0, 0, 0, 0.8); /* ç§»é™¤æ–‡å­—é™°å½± */
        }
    </style>
</head>
<body class="bg-gray-50 font-sans dark:bg-[#282828] transition-colors duration-300">

    <div id="app" class="max-w-screen-2xl mx-auto p-4 md:p-8">

        <header class="mb-6 flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-3xl font-bold text-gray-700 dark:text-[#ebdbb2]" data-i18n="app_title">Flavor Wheel Note</h1>
            <div class="flex flex-wrap justify-center md:justify-end gap-2 mt-4 md:mt-0">
                <div id="drink-switch" class="flex p-1 bg-white rounded-lg shadow dark:bg-[#504945]">
                    <button data-type="coffee" data-i18n="coffee_button" class="p-2 rounded-md bg-[#fe8019] text-white font-semibold transition">â˜• å’–å•¡</button>
                    <button data-type="tea" data-i18n="tea_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸµ èŒ¶</button>
                    <button data-type="luxury" data-i18n="luxury_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸ’ å¥¢è¯</button>
                </div>
                <div id="lang-switch" class="flex p-1 bg-white rounded-lg shadow shrink-0 dark:bg-[#504945]">
                    <button data-lang="zh" data-i18n="lang_zh_button" class="p-2 rounded-md bg-[#458588] text-white font-semibold transition">ä¸­</button>
                    <button data-lang="en" data-i18n="lang_en_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">EN</button>
                    <button data-lang="jp" data-i18n="lang_jp_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">æ—¥</button>
                </div>
                <div id="theme-switch" class="flex p-1 bg-white rounded-lg shadow dark:bg-[#504945]">
                    <button data-theme="default" data-i18n="theme_default_button" class="p-2 rounded-md bg-[#d3869b] text-white font-semibold transition">ğŸ¨ Default</button>
                    <button data-theme="catppuccin" data-i18n="theme_catppuccin_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸ¨ Catppuccin</button>
                    <button data-theme="gruvbox" data-i18n="theme_gruvbox_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸ¨ Gruvbox</button>
                </div>
                <div id="luxury-theme-switch" class="flex p-1 bg-white rounded-lg shadow mr-2 hidden dark:bg-[#504945]">
                    <button data-theme="luxury_gold" data-i18n="theme_luxury_gold_button" class="p-2 rounded-md bg-[#fabd2f] text-[#3c3836] font-semibold transition">âšœï¸ å¥¢è¯é‡‘</button>
                    <button data-theme="rose_gold" data-i18n="theme_rose_gold_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸŒ¹ ç«ç‘°é‡‘</button>
                    <button data-theme="platinum" data-i18n="theme_platinum_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸ’ é‰‘é‡‘</button>
                </div>
                <div id="tea-theme-switch" class="flex p-1 bg-white rounded-lg shadow mr-2 hidden dark:bg-[#504945]">
                    <button data-theme="spring_garden" data-i18n="theme_tea_spring_button" class="p-2 rounded-md bg-[#a6d189] text-[#3c3836] font-semibold transition">ğŸŒ± æ˜¥æ—¥èŒ¶åœ’</button>
                    <button data-theme="autumn_roast" data-i18n="theme_tea_autumn_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸ‚ ç§‹æ—¥ç„™èŒ¶</button>
                    <button data-theme="midnight_contemplation" data-i18n="theme_tea_midnight_button" class="p-2 rounded-md text-gray-500 hover:bg-gray-100 transition">ğŸŒ™ éœå¤œæ²‰æ€</button>
                </div>
                <div id="dark-mode-switch" class="flex p-1 bg-white rounded-lg shadow dark:bg-[#504945]">
                    <button id="dark-mode-toggle" class="p-2 rounded-md text-gray-600 hover:bg-gray-100 dark:text-gray-300 dark:hover:bg-gray-700 transition">
                        <svg id = "sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                          <path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z" />
                        </svg>
                        <svg id="moon-icon" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 hidden" viewBox="0 0 20 20" fill="currentColor">
                            <path d="M17.293 13.293A8 8 0 016.707 2.707a8.001 8.001 0 1010.586 10.586z" />
                        </svg>
                    </button>
                </div>
            </div>
        </header>
                
        <main class="grid grid-cols-1 gap-8 items-start">
            <div class="relative bg-white rounded-xl shadow-lg flavor-wheel-container dark:bg-[#3c3836] overflow-hidden transition-opacity duration-300 ease-in-out">
                <div id="flavor-wheel">
                    </div>
                <div id="center-display" class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 pointer-events-none text-center px-4">
                    <p id="current-category" class="text-sm text-gray-500 dark:text-[#a89984]"></p> 
                    <p id="current-flavor" class="font-bold text-gray-800 dark:text-[#ebdbb2]"></p> 
                    <p class="text-xs mt-2 text-gray-400 dark:text-[#928374]" data-i18n="click_to_select_flavor">é»æ“Šé¸æ“‡é¢¨å‘³</p>
                </div>
            </div>

            <div class="space-y-6">

                <div class="bg-white p-5 rounded-xl shadow-lg dark:bg-[#3c3836]">
                    <div class="flex justify-between items-center mb-2">
                        <h4 class="text-lg font-semibold text-gray-700 dark:text-[#ebdbb2]" data-i18n="selected_flavors_title">é¸å–é¢¨å‘³åˆ—è¡¨</h4>
                        <button id="reset-flavors-btn" class="text-sm text-gray-500 hover:text-red-600 dark:text-[#a89984] dark:hover:text-[#fb4934] transition hidden" data-i18n="reset_flavors_button">é‡è¨­åˆ—è¡¨</button>
                    </div>
                    <div id="selected-flavors" class="min-h-[50px] p-3 border rounded-lg bg-gray-50 space-y-1 dark:bg-[#282828] dark:border-[#665c54]">
                        <p class="text-sm text-gray-400 dark:text-[#a89984]" data-i18n="no_flavors_selected">å°šæœªé¸å–ä»»ä½•é¢¨å‘³...</p>
                    </div>

                    <h2 class="text-xl font-semibold mt-4 mb-3 text-gray-700 dark:text-[#ebdbb2]" data-i18n="generate_note_title">ç”Ÿæˆç­†è¨˜</h2>
                    
                    <div id="output-mode-switch" class="flex mb-3 p-1 bg-gray-100 rounded-lg dark:bg-[#282828]">
                        <button data-mode="list" data-i18n="output_mode_list" class="flex-1 p-2 rounded-md text-gray-500 text-sm hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-[#504945]">1ï¸âƒ£ ç´”é¢¨å‘³æ–‡å­—</button>
                        <button data-mode="note" data-i18n="output_mode_note" class="flex-1 p-2 rounded-md bg-[#8ec07c] text-[#3c3836] text-sm font-medium">2ï¸âƒ£ ç¤¾ç¾¤åˆ†äº«æ¨¡å¼</button>
                        <button data-mode="ai_prompt" data-i18n="output_mode_ai_prompt" class="flex-1 p-2 rounded-md text-gray-500 text-sm hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-[#504945]">ğŸ¤– AI ç­†è¨˜åŠ©æ‰‹</button>
                    </div>

                    <textarea id="output-textarea" rows="6" class="w-full p-3 border rounded-lg resize-none text-sm font-mono bg-gray-50 dark:bg-[#504945] dark:border-[#665c54] dark:text-[#ebdbb2]" readonly></textarea>
                    
                    <button id="copy-btn" data-i18n="copy_button" class="w-full mt-3 py-2 px-4 bg-[#665c54] text-[#ebdbb2] font-bold rounded-lg hover:bg-[#7c6f64] transition">ğŸ“‹ è¤‡è£½åˆ°å‰ªè²¼ç°¿</button>
                    <button id="share-btn" data-i18n="share_button" class="w-full mt-2 py-2 px-4 bg-[#458588] text-white font-bold rounded-lg hover:bg-[#83a598] transition hidden">ğŸ”— åˆ†äº« (Web Share API)</button>
                </div>
                
                <div class="bg-white p-5 rounded-xl shadow-lg dark:bg-[#3c3836]">
                    <h2 class="text-xl font-semibold mb-3 text-gray-700 dark:text-[#ebdbb2]" data-i18n="settings_title">ç­†è¨˜è¨­å®šèˆ‡è‡ªè¨‚é¢¨å‘³</h2>
                    <label for="input-origin" class="block mb-2 text-sm font-medium text-gray-700 dark:text-[#d5c4a1]" data-i18n="origin_label">å“å / ç”¢å€ (Origin)</label>
                    <input type="text" id="input-origin" data-i18n-placeholder="origin_placeholder" placeholder="e.g. Ethiopia Yirgacheffe" class="w-full p-2 border rounded-lg mb-4 bg-gray-50 dark:bg-[#504945] dark:border-[#665c54] dark:text-[#ebdbb2] dark:placeholder-gray-500">
                    <h3 class="text-lg font-medium mb-3 text-gray-700 border-t pt-4 dark:text-[#ebdbb2] dark:border-gray-600" data-i18n="add_custom_flavor_heading">æ‰‹å‹•æ–°å¢è‡ªè¨‚é¢¨å‘³</h3>
                    
                    <label for="custom-flavor-input" class="block mb-2 text-sm font-medium text-gray-700 dark:text-[#d5c4a1]" data-i18n="custom_flavor_name_label">é¢¨å‘³åç¨± (å°‡ç”¨æ–¼ç­†è¨˜)</label>
                    <input type="text" id="custom-flavor-input" data-i18n-placeholder="custom_flavor_name_placeholder" placeholder="e.g. ä¸ƒé‡Œé¦™ã€ä¹å±¤å¡”" class="w-full p-2 border rounded-lg mb-4 bg-gray-50 dark:bg-[#504945] dark:border-[#665c54] dark:text-[#ebdbb2] dark:placeholder-gray-500">
                    
                    <label for="custom-flavor-category" class="block mb-2 text-sm font-medium text-gray-700 dark:text-[#d5c4a1]" data-i18n="select_category_label">é¸æ“‡é¡åˆ¥ (æ±ºå®šé †åº)</label>
                    <select id="custom-flavor-category" class="w-full p-2 border rounded-lg mb-4 bg-gray-50 dark:bg-[#504945] dark:border-[#665c54] dark:text-[#ebdbb2]">
                        <option value="" data-i18n="select_category_default">-- è«‹é¸æ“‡ Layer 1 å¤§é¡åˆ¥ --</option>
                        </select>
                    
                    <button id="add-custom-flavor-btn" data-i18n="add_custom_flavor_button" class="w-full py-2 bg-[#665c54] text-[#ebdbb2] font-bold rounded-lg hover:bg-[#7c6f64] transition disabled:bg-gray-400" disabled>
                        â• æ–°å¢è‡ªè¨‚é¢¨å‘³
                    </button>
                </div>
            </div>
        </main>
        
        <footer class="text-center mt-8 text-xs text-gray-500 max-w-4xl mx-auto dark:text-[#a89984]">
            <p id="attribution-text" class="leading-relaxed"></p>
        </footer>
        <script src="js/localization.js"></script>
        <script src="js/colorThemes.js"></script> 
        <script src="js/luxuryColorThemes.js"></script>
        <script src="js/teaColorThemes.js"></script>
        <script src="js/flavorWheel.js"></script>
        <script src="js/app.js"></script>
    </div>
</body>
</html>